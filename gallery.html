<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Memories</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400&display=swap');
        body{margin:0;padding:0;font-family:'Poppins',sans-serif;background:#ffe8e8;color:#5c3c3c;min-height:100vh;overflow-x:hidden;text-align:center}
        .background-effects{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;overflow:hidden}
        .background-effects .particle{position:absolute;height:auto;opacity:0}
        .background-effects .heart{animation:floatUp 20s infinite linear}
        .background-effects .rose{animation:floatUpRotate 25s infinite linear}
        .background-effects .heart svg{width:100%;height:100%;fill:rgba(255,105,180,0.6);filter:blur(2px)}
        .background-effects .rose svg{width:100%;height:100%;fill:rgba(220,40,40,0.5);filter:blur(3px)}
        @keyframes floatUp{0%{transform:translateY(100vh) scale(0.5);opacity:0}10%{opacity:0.9}90%{opacity:0.9}100%{transform:translateY(-10vh) scale(1.2);opacity:0}}
        @keyframes floatUpRotate{0%{transform:translateY(100vh) scale(0.6) rotate(0deg);opacity:0}10%{opacity:0.8}90%{opacity:0.8}100%{transform:translateY(-10vh) scale(1.1) rotate(220deg);opacity:0}}
        .glitter{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:2}
        .glitter::after{content:'';position:absolute;width:100%;height:100%;background:transparent;background-image:radial-gradient(circle,rgba(255,255,255,0.7) 1px,transparent 1px),radial-gradient(circle,rgba(255,255,255,0.7) 1px,transparent 1px);background-size:50px 50px,30px 30px;background-position:0 0,15px 15px;animation:sparkle 5s infinite linear}
        @keyframes sparkle{0%{background-position:0 0,15px 15px}100%{background-position:50px 50px,45px 45px}}
        .gallery-container{width:90%;max-width:1200px;margin:50px auto;padding:40px;background-color:rgba(255,255,255,0.4);border-radius:20px;border:1px solid rgba(255,255,255,0.6);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:0 8px 32px 0 rgba(100,50,50,0.2)}
        h1{font-family:'Great Vibes',cursive;font-size:4rem;margin:0 0 10px 0;color:#c7435a;text-shadow:0 0 5px rgba(255,255,255,0.7)}
        h2{font-size:1.2rem;font-weight:300;margin-bottom:40px}
        .photo-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:25px}
        .photo-link{text-decoration:none;color:inherit;position:relative;display:block}
        .photo-item{background:#fff;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.1);overflow:hidden;transition:transform .3s,box-shadow .3s}
        .photo-link.unlocked .photo-item:hover{transform:translateY(-10px);box-shadow:0 8px 25px rgba(0,0,0,0.2)}
        .photo-item img{width:100%;height:220px;object-fit:cover;display:block;transition:filter .5s ease}
        .photo-item .caption{padding:15px;font-size:.9rem;color:#5c3c3c;min-height:50px}
        .photo-link.locked img{filter:blur(8px)}
        .photo-link.locked{pointer-events:none;cursor:not-allowed}
        .unlock-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.3);color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:15px;text-shadow:0 1px 3px rgba(0,0,0,0.5);opacity:1;transition:opacity .5s}
        .photo-link.unlocked .unlock-overlay{opacity:0;pointer-events:none}
        .unlock-overlay p{margin:2px 0}
        .unlock-time-text{font-size:1.1rem;font-weight:bold}
        .unlock-countdown{font-size:.9rem}
        .back-button{display:inline-block;margin-top:40px;padding:12px 25px;font-size:1rem;color:#fff;background-color:#c7435a;border-radius:50px;text-decoration:none;transition:background-color .3s}
        .back-button:hover{background-color:#a53246}
    </style>
</head>
<body>
    <div class="background-effects"></div>
    <div class="glitter"></div>
    <div class="gallery-container">
        <h1>A Walk Through Our Moments</h1>
        <h2 id="gallery-subtitle">Surprises will unlock starting the day before the birthday!</h2>
        <div class="photo-grid">
            <!-- ✍️ EDIT UNLOCK TIMES for the day BEFORE the birthday -->
            <a href="photo1.html" class="photo-link" data-unlock-hour="11" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 2:30 PM</p><p class="unlock-countdown"></p></div><img src="photo1.jpg" alt="❤️ Happy Birthday My Love ❤️ 1"><p class="caption">Memory 1</p></div></a>
            <a href="photo2.html" class="photo-link" data-unlock-hour="15" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 3:00 PM</p><p class="unlock-countdown"></p></div><img src="photo2.jpg" alt="❤️ Happy Birthday My Love ❤️ 2"><p class="caption">Memory 2</p></div></a>
            <a href="photo3.html" class="photo-link" data-unlock-hour="15" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 3:30 PM</p><p class="unlock-countdown"></p></div><img src="photo3.jpg" alt="❤️ Happy Birthday My Love ❤️ 3"><p class="caption">Memory 3</p></div></a>
            <a href="photo4.html" class="photo-link" data-unlock-hour="16" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 4:00 PM</p><p class="unlock-countdown"></p></div><img src="photo4.jpg" alt="❤️ Happy Birthday My Love ❤️ 4"><p class="caption">Memory 4</p></div></a>
            <a href="photo5.html" class="photo-link" data-unlock-hour="16" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 4:30 PM</p><p class="unlock-countdown"></p></div><img src="photo5.jpg" alt="❤️ Happy Birthday My Love ❤️ 5"><p class="caption">Memory 5</p></div></a>
            <a href="photo6.html" class="photo-link" data-unlock-hour="17" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 5:00 PM</p><p class="unlock-countdown"></p></div><img src="photo6.jpg" alt="❤️ Happy Birthday My Love ❤️ 6"><p class="caption">Memory 6</p></div></a>
            <a href="photo7.html" class="photo-link" data-unlock-hour="17" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 5:30 PM</p><p class="unlock-countdown"></p></div><img src="photo7.jpg" alt="❤️ Happy Birthday My Love ❤️ 7"><p class="caption">Memory 7</p></div></a>
            <a href="photo8.html" class="photo-link" data-unlock-hour="18" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 6:00 PM</p><p class="unlock-countdown"></p></div><img src="photo8.jpg" alt="❤️ Happy Birthday My Love ❤️ 8"><p class="caption">Memory 8</p></div></a>
            <a href="photo9.html" class="photo-link" data-unlock-hour="18" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 6:30 PM</p><p class="unlock-countdown"></p></div><img src="photo9.jpg" alt="❤️ Happy Birthday My Love ❤️ 9"><p class="caption">Memory 9</p></div></a>
            <a href="photo10.html" class="photo-link" data-unlock-hour="19" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 7:00 PM</p><p class="unlock-countdown"></p></div><img src="photo10.jpg" alt="❤️ Happy Birthday My Love ❤️ 10"><p class="caption">Memory 10</p></div></a>
            <a href="photo11.html" class="photo-link" data-unlock-hour="19" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 7:30 PM</p><p class="unlock-countdown"></p></div><img src="photo11.jpg" alt="❤️ Happy Birthday My Love ❤️ 11"><p class="caption">Memory 11</p></div></a>
            <a href="photo12.html" class="photo-link" data-unlock-hour="20" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 8:00 PM</p><p class="unlock-countdown"></p></div><img src="photo12.jpg" alt="❤️ Happy Birthday My Love ❤️ 12"><p class="caption">Memory 12</p></div></a>
            <a href="photo13.html" class="photo-link" data-unlock-hour="20" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 8:30 PM</p><p class="unlock-countdown"></p></div><img src="photo13.jpg" alt="❤️ Happy Birthday My Love ❤️ 13"><p class="caption">Memory 13</p></div></a>
            <a href="photo14.html" class="photo-link" data-unlock-hour="21" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 9:00 PM</p><p class="unlock-countdown"></p></div><img src="photo14.jpg" alt="❤️ Happy Birthday My Love ❤️ 14"><p class="caption">Memory 14</p></div></a>
            <a href="photo15.html" class="photo-link" data-unlock-hour="21" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 9:30 PM</p><p class="unlock-countdown"></p></div><img src="photo15.jpg" alt="❤️ Happy Birthday My Love ❤️ 15"><p class="caption">Memory 15</p></div></a>
            <a href="photo16.html" class="photo-link" data-unlock-hour="22" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 10:00 PM</p><p class="unlock-countdown"></p></div><img src="photo16.jpg" alt="❤️ Happy Birthday My Love ❤️ 16"><p class="caption">Memory 16</p></div></a>
            <a href="photo17.html" class="photo-link" data-unlock-hour="22" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 10:30 PM</p><p class="unlock-countdown"></p></div><img src="photo17.jpg" alt="❤️ Happy Birthday My Love ❤️ 17"><p class="caption">Memory 17</p></div></a>
            <a href="photo18.html" class="photo-link" data-unlock-hour="23" data-unlock-minute="0"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 11:00 PM</p><p class="unlock-countdown"></p></div><img src="photo18.jpg" alt="❤️ Happy Birthday My Love ❤️ 18"><p class="caption">Memory 18</p></div></a>
            <a href="photo19.html" class="photo-link" data-unlock-hour="23" data-unlock-minute="30"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 11:30 PM</p><p class="unlock-countdown"></p></div><img src="photo19.jpg" alt="❤️ Happy Birthday My Love ❤️ 19"><p class="caption">Memory 19</p></div></a>
            <a href="photo20.html" class="photo-link" data-unlock-hour="24" data-unlock-minute="00"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 12:00 AM</p><p class="unlock-countdown"></p></div><img src="photo20.jpg" alt="❤️ Happy Birthday My Love ❤️ 20"><p class="caption">Memory 20</p></div></a>
            <a href="photo21.html" class="photo-link" data-unlock-hour="24" data-unlock-minute="00"><div class="photo-item"><div class="unlock-overlay"><p class="unlock-time-text">Unlocks at 12:00 AM</p><p class="unlock-countdown"></p></div><img src="photo21.jpg" alt="❤️ Happy Birthday My Love ❤️ Get Your D"><p class="caption">A final surprise... see it in private</p></div></a>
        </div>
        <a href="index.html" class="back-button">← Back to Birthday Wish</a>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const birthdayISO = urlParams.get('bday');
            if (!birthdayISO) { document.getElementById('gallery-subtitle').innerText = "Error: Birthday date not found."; return; }
            
            const birthdayDate = new Date(birthdayISO);
            const photoLinks = document.querySelectorAll('.photo-link');

            // **NEW LOGIC**: Get the day BEFORE the birthday
            const dayBeforeBirthday = new Date(birthdayDate);
            dayBeforeBirthday.setDate(birthdayDate.getDate() - 1);

            photoLinks.forEach(link => {
                const originalHref = link.getAttribute('href');
                link.setAttribute('href', `${originalHref}?bday=${birthdayISO}`);
                link.classList.add('locked');
            });

            const interval = setInterval(() => {
                const now = new Date();
                let allUnlocked = true;
                photoLinks.forEach(link => {
                    if (!link.classList.contains('locked')) return;
                    allUnlocked = false;

                    // Manually read the hour and minute for each photo
                    const unlockHour = parseInt(link.getAttribute('data-unlock-hour'), 10);
                    const unlockMinute = parseInt(link.getAttribute('data-unlock-minute') || '0', 10);
                    
                    // Create the unlock date based on the DAY BEFORE the birthday
                    const unlockDate = new Date(dayBeforeBirthday);
                    unlockDate.setHours(unlockHour, unlockMinute, 0, 0);

                    const countdownEl = link.querySelector('.unlock-countdown');
                    if (now >= unlockDate) {
                        link.classList.remove('locked');
                        link.classList.add('unlocked');
                    } else {
                        const distance = unlockDate - now;
                        if (distance > 0) {
                            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                            let countdownText = "in ";
                            if (days > 0) countdownText += `${days}d `;
                            countdownText += `${hours}h ${minutes}m ${seconds}s`;
                            countdownEl.textContent = countdownText;
                        }
                    }
                });
                if (allUnlocked) {
                    document.getElementById('gallery-subtitle').innerText = "All your surprises have been unlocked!";
                    clearInterval(interval);
                }
            }, 1000);
            createFloatingParticles();
        });
        function createFloatingParticles() {
            const container = document.querySelector('.background-effects');
            if (!container) return;
            const particleTypes = [
                { class: 'heart', count: 10, innerHTML: `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>` },
                { class: 'rose', count: 8, innerHTML: `<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2C9.2,2,7,4.2,7,7c0,1.5,0.6,2.8,1.6,3.8C7.2,11.5,6.1,12.7,6,14c-0.1,1,0.4,1.9,0.9,2.7C6.4,17.5,6,18.7,6,20 c0,1.1,0.9,2,2,2h8c1.1,0,2-0.9,2-2c0-1.3-0.4-2.5-1-3.3c0.5-0.8,1-1.7,0.9-2.7c-0.1-1.3-1.2-2.5-2.6-3.2C16.4,9.8,17,8.5,17,7 C17,4.2,14.8,2,12,2z M12,4c1.7,0,3,1.3,3,3c0,1-0.5,1.9-1.3,2.5C13.2,9.2,12.6,9,12,9s-1.2,0.2-1.7,0.5C9.5,8.9,9,8,9,7 C9,5.3,10.3,4,12,4z"/></svg>` }
            ];
            particleTypes.forEach(type => {
                for (let i = 0; i < type.count; i++) {
                    const p = document.createElement('div');
                    p.classList.add('particle', type.class);
                    p.style.left = Math.random() * 100 + 'vw';
                    p.style.animationDuration = (Math.random() * 10 + 15) + 's';
                    p.style.animationDelay = Math.random() * 15 + 's';
                    const size = Math.random() * 50 + 40;
                    p.style.width = size + 'px';
                    p.style.height = size + 'px';
                    p.innerHTML = type.innerHTML;
                    container.appendChild(p);
                }
            });
        }
    </script>
</body>
</html>
